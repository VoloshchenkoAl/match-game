(this["webpackJsonppicture-matching-game"]=this["webpackJsonppicture-matching-game"]||[]).push([[0],{44:function(e,t,n){e.exports=n(63)},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(33),o=n(41),i=n.n(o),u=n(18),s=n(7),d=n(17),l=n(16),m=n.n(l),p=n(21),h=n(13),f=n(32),g=n(3),E=/\w./;var b=Object(f.b)({id:"initGameMachine",initial:"editing",context:{value:"",error:""},states:{editing:{initial:"idle",states:{idle:{},invalid:{}},on:{CHANGE:{actions:["clearErrorCode","setValue"],target:".idle"},SUBMIT:"validating"}},validating:{invoke:{id:"validating",src:function(e){return t=e.value,new Promise((function(e,n){0===t.length?n("EMPTY"):E.test(t)?e():n("INVALID_CHARACTERS")}));var t},onDone:"validated",onError:{target:"editing.invalid",actions:"setError"}}},validated:{entry:["clearErrorCode"],invoke:{id:"submitForm",src:"submit",onDone:"editing",onError:{target:"editing.invalid",actions:"setError"}}}}},{actions:{clearErrorCode:Object(g.b)((function(e){return Object(h.a)(Object(h.a)({},e),{},{errorCode:void 0})})),setValue:Object(g.b)({value:function(e,t){return t.value}}),setError:Object(g.b)({error:function(e,t){return t.data.toString()}})}}),v=(n(50),function(e){var t=e.onChange,n=e.value,a=e.label,c=e.type,o=e.error;return r.a.createElement("div",null,r.a.createElement("label",null,a?r.a.createElement("span",null,a):null,r.a.createElement("input",{className:"input",type:c,value:n,onChange:function(e){var n=e.target.value;t(n)}}),o?r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("span",{style:{color:"tomato"}},o)):null))});v.displayName="Input",v.defaultProps={type:"text"};n(51);var C=function(e){var t=e.children,n=e.onClick,a=e.type;return r.a.createElement("button",{type:a,className:"button",onClick:n},t)};C.defaultProps={type:"button"};n(52);var O=function(e){var t=e.handleInputChange,n=e.handleSearchImages,a=e.value,c=e.searchValidationError;return r.a.createElement("div",{className:"start-game__container"},r.a.createElement("h1",null,"Write any word to start to play the game"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n()},className:"start-game__form"},r.a.createElement(v,{value:a,onChange:t,error:c}),r.a.createElement(C,{type:"submit"},"start game!")))},y=n(34),j=n.n(y);function w(e,t){if(!t)return e;var n=null;n="string"===typeof t?j.a.parse(t):t;var a=j.a.stringify(n);return"".concat(e,"?").concat(a)}function M(e,t,n){var a={method:e,headers:{}};return"object"===typeof n&&(a.headers=n),"object"===typeof t&&(a.body=JSON.stringify(t),a.headers["Content-Type"]="application/json"),a}function k(e){return T.apply(this,arguments)}function T(){return(T=Object(p.a)(m.a.mark((function e(t){var n,a,r,c,o,i,u,s,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,a=t.method,r=t.query,c=t.data,o=t.headers,i=w(n,r),u=M(a,c,o),e.next=5,fetch(i,u);case 5:if((s=e.sent).ok){e.next=8;break}throw new Error("".concat(s.statusText," ").concat(s.status," for url ").concat(n));case 8:return e.next=10,s.json();case 10:return d=e.sent,e.abrupt("return",d);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=function(e){var t=e.results,n=[];return t.forEach((function(e){var t={id:e.id,uniqKey:e.id,author:{name:e.user.name,link:e.user.links.self},description:e.description,image:{link:e.urls.regular}};n.push(t)})),n},I=function(e){return Object(p.a)(m.a.mark((function t(){var n,a,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://api.unsplash.com/search/photos","GET",n={Authorization:"Client-ID ".concat("OsYnyEfemwLLpoZ0pApQL38x1KYwg2MR4ZgkUPICnGs")},a={query:e,orientation:"landscape"},t.next=6,k({url:"https://api.unsplash.com/search/photos",method:"GET",headers:n,query:a});case 6:return r=t.sent,t.abrupt("return",A(r));case 8:case"end":return t.stop()}}),t)})))()},S=function(e){var t,n=e.handleLoadCars,a=Object(d.useMachine)(b,{services:{submit:function(e){return Object(p.a)(m.a.mark((function t(){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I(e.value);case 2:a=t.sent,n(a);case 4:case"end":return t.stop()}}),t)})))()}}}),c=Object(u.a)(a,2),o=c[0],i=c[1],s="EMPTY"===(t=o.context.error)?"Field is empty":"INVALID_CHARACTERS"===t?"Try to change your characters":"NO_RESULT"===t?"Can not find any photos":t;return r.a.createElement(O,{searchValidationError:s,handleInputChange:function(e){i({type:"CHANGE",value:e})},value:o.context.value,handleSearchImages:function(){i({type:"SUBMIT"})}})},x=n(19),R=Object(f.a)({id:"cardMachine",initial:"unguessed",states:{revealed:{on:{DETAIL:{target:"detailed"}}},unguessed:{on:{REVEAL:{target:"revealed"}}},detailed:{on:{REVEAL_DETAILED:{target:"revealed"}}}},on:{UNGUESSED:{target:"unguessed"}}}),L=(n(56),function(e){var t=Object(d.useMachine)(R),n=Object(u.a)(t,2),c=n[0],o=n[1],i=e.isRevealed,s=e.image,l=e.description,m=e.author,p=e.id,h=e.onClick,f=e.uniqKey;Object(a.useEffect)((function(){o({type:i?"REVEAL":"UNGUESSED"})}),[i,o]);return r.a.createElement("div",{className:"game-card",onClick:function(){return h({id:p,uniqKey:f})},onMouseEnter:function(){o({type:"DETAIL"})},onMouseLeave:function(){o({type:"REVEAL_DETAILED"})}},c.matches("unguessed")?r.a.createElement("div",{className:"game-card__hide"}):r.a.createElement("div",{className:"game-card-info"},r.a.createElement("img",{src:s.link,alt:l}),c.matches("detailed")?r.a.createElement("div",{className:"game-card-detailed"},r.a.createElement("span",null,m.name," on ",r.a.createElement("a",{href:m.link},"Unsplash"))):null))}),N=(n(57),function(e){var t=e.cards,n=e.openedCards,a=e.handleClick,c=e.forceOpenedCards,o=e.attempts,i=e.countdownTime,u=e.isCountdownEnd;return r.a.createElement("section",{className:"game_section"},u&&r.a.createElement("h2",null,"You have ",3-o," attempts"),!u&&r.a.createElement("h2",null,"Game start at ",i/1e3," seconds"),r.a.createElement("section",{className:"game_play"},t.map((function(e){return r.a.createElement(L,Object.assign({isRevealed:c||n.some((function(t){return t.uniqKey===e.uniqKey})),key:e.uniqKey,onClick:a},e))}))))}),_=n(22),D=Object(f.a)({id:"countdown",initial:"idle",context:{timer:5e3},states:{idle:{on:{START:{target:"start"}}},start:{initial:"countdown",states:{countdown:{after:Object(_.a)({},1e3,{target:"checkCountdown",actions:"countdownTick"})},checkCountdown:{on:{"":[{target:"#countdown.end",cond:"checkCountdown"},{target:"countdown"}]}}}},end:{entry:"countdownEnd",on:{RESTART:{target:"start",actions:["restartTimer"]}}}}},{actions:{restartTimer:Object(g.b)({timer:function(){return 5e3}}),countdownTick:Object(g.b)({timer:function(e){return e.timer-1e3}})},guards:{checkCountdown:function(e){return 0===e.timer}}}),G=function(e){var t=e.state,n=e.dispatcher,c=Object(d.useMachine)(D,{actions:{countdownEnd:function(){n({type:"PLAY"})}}}),o=Object(u.a)(c,2),i=o[0],s=o[1];Object(a.useEffect)((function(){s({type:"START"})}),[s]);var l=t.context,m=l.cards,p=l.roundMatch,h=l.openCards,f=l.forceOpenedCards,g=l.attempts,E=Array.from(new Set([].concat(Object(x.a)(p),Object(x.a)(h))));return r.a.createElement(N,{cards:m,openedCards:E,handleClick:function(e){n({type:"MATCH",cardImprint:e})},forceOpenedCards:f,attempts:g,countdownTime:i.context.timer,isCountdownEnd:i.matches("end")})},q=Object(f.a)({id:"gameMachine",initial:"start",context:{sourceCard:[],cards:[],attempts:0,roundMatch:[],openCards:[],forceOpenedCards:!0},states:{start:{on:{SET_CARDS:{target:"prepare",actions:"setCards"}}},prepare:{on:{PLAY:{target:"playing",actions:"hideForceOpenedCards"}}},playing:{initial:"idle",states:{idle:{on:{MATCH:{actions:"setRoundMatch",target:"roundMatch"}}},roundMatch:{after:Object(_.a)({},500,[{target:"gameMatch",cond:"checkRound"},{target:"idle"}])},gameMatch:{entry:"updateCardsInfo",on:{"":[{target:"#gameMachine.gameOver",cond:"gameOverCheck"},{target:"#gameMachine.win",cond:"winCheck"},{target:"idle"}]}}}},gameOver:{entry:"gameOver"},win:{entry:"gameWin"},exit:{type:"final"}},on:{EXIT_GAME:{target:"exit"},PLAY_AGAIN:{target:"playing",actions:"resetGame"}}},{actions:{hideForceOpenedCards:Object(g.b)({forceOpenedCards:function(e,t){return!1}}),setCards:Object(g.b)({cards:function(e,t){for(var n=[],a=t.cards,r=0;r<2;r++)n=[].concat(Object(x.a)(n),Object(x.a)(a));return(n=n.map((function(e,t){return Object(h.a)(Object(h.a)({},e),{},{uniqKey:e.uniqKey+t})}))).sort((function(){return Math.random()-.5}))},sourceCard:function(e,t){return t.cards}}),setRoundMatch:Object(g.b)({roundMatch:function(e,t){return e.roundMatch.concat(t.cardImprint)}}),updateCardsInfo:Object(g.b)((function(e){var t=e.openCards,n=e.attempts,a=e.roundMatch;return a.every((function(e){return e.id===a[0].id}))?Object(h.a)(Object(h.a)({},e),{},{roundMatch:[],openCards:[].concat(Object(x.a)(t),Object(x.a)(a))}):Object(h.a)(Object(h.a)({},e),{},{roundMatch:[],attempts:n+1})})),resetGame:Object(g.b)((function(e){return Object(h.a)(Object(h.a)({},e),{},{attempts:0,openCards:[],roundMatch:[]})}))},guards:{checkRound:function(e){return 2===e.roundMatch.length},gameOverCheck:function(e){return e.attempts>=3},winCheck:function(e){return e.openCards.length===e.cards.length}}}),V=function(){var e=Object(s.g)(),t=Object(d.useMachine)(q,{actions:{gameOver:function(){return e.push("/game-over")},gameWin:function(){return e.push("/win")}}}),n=Object(u.a)(t,2),a=n[0],c=n[1];return r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/game"},a.context.sourceCard.length>0?r.a.createElement(G,{state:a,dispatcher:c}):r.a.createElement(s.a,{to:"/"})),r.a.createElement(s.b,{path:"/game-over"},r.a.createElement("h1",null,"Your Loose the game!")),r.a.createElement(s.b,{path:"/win"},r.a.createElement("h1",null,"Your Win!")),r.a.createElement(s.b,{path:"/"},r.a.createElement(S,{handleLoadCars:function(t){c({type:"SET_CARDS",cards:t}),e.push("/game")}})))};n(62);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,null,r.a.createElement(V,null))),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.facbfd74.chunk.js.map